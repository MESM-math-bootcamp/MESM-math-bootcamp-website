---
format: 
  revealjs:
    chalkboard: true
    slide-number: true
    show-slide-number: print
    theme:
     - ../../ucsb-media.scss    
    html-math-method: mathjax
---

## {#title-slide data-menu-title="Title Slide" background=.white}

[Differential Equations and Numerical Calculus]{.custom-title .blue-text}

[Bren Calculus Workshop]{.custom-subtitle .gold}

<hr class="hr-teal">

[Carmen Galaz García, Ph.D.]{.body-text-l .center-text .blue-text}

[Bren School of Environmental Science & Management]{.center-text .body-text-m .blue-text}

<br>

<br>

[**Last updated:** `r format(Sys.time(), '%b %d, %Y')`]{.body-text-s .blue-text}

<br>

*Materials have been adapted and expanded from Nathaniel Grimes work for the Bren Calculus Workshop.*

<!--
## {#ta2-1 data-menu-title="Team Assessment 2 Questions"}


2) Take the Integrals

$$
\begin{align}
\text{A) }y=\frac{3}{x^2}, y(0)=5&  &\text{B)  }g(t)=3t^5-2t^3+16t-7  &  &\text{C) } \int^4_2\frac{1}{2}x
\end{align}
$$

3) A model for the rate of change in ozone concentrations over time between 1962-1984 is given by $\frac{dC}{dt}=2t+20$. Where $C$ is the ozone concentration (ppm) and t is the elapsed time in years. Given that in 1964 the ozone concentration was 30 ppm, what was the ozone concentration in 1982?
-->

## {#ln data-menu-title="Natural Logs"}

[Integral of the exponential function]{.slide-title}

<hr>

Since $\frac{d}{dx}e^x = e^x$, we have that

$$
\large
\int e^xdx=e^x+C
$$

<br>

- If the $x$ term gets more complex, we need [integration by parts](https://tutorial.math.lamar.edu/classes/calcii/integrationbyparts.aspx) or [substitution](https://tutorial.math.lamar.edu/classes/calci/substitutionruleindefinite.aspx). 

*This can get complicated and ee will not cover it in the workshop.*


## {#int-ln-blank data-menu-title="Natural logs"}

[Natural logs in integration]{.slide-title}

<hr>

<!----------------------------------------------------->

## {#int-ln data-menu-title="Natural logs"}

[Natural logs in integration]{.slide-title}

<hr>

Since $\frac{d}{dx} \ln(x) = \frac{1}{x}$ we have that

$$
\large
\int \frac{1}{x}=\ln x+C.
$$


On the other hand, we have that

$$
\begin{align}
\int \ln x&=x\ln x-x+C  
\end{align}
$$


This is computed using [integration by parts](https://www.youtube.com/watch?v=iw5eLJV0Sj4&embeds_referring_euri=https%3A%2F%2Fwww.khanacademy.org%2F&embeds_referring_origin=https%3A%2F%2Fwww.khanacademy.org).

✏️ [How would you check this second integral is correct?]{style="color:green;"}

<!----------------------------------------------------->

## {#intro-diff-eq data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Introduction to Differential Equations</div>
</div>

<!----------------------------------------------------->


## {#diffeq-blank-1 data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

<!----------------------------------------------------->


## {#diffeq-blank-2 data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

A **differential equation** is any equation which contains derivatives. 

The goal of the differential equation is to find a function that satisfies the equation. 

**Ordinary differential equations (ODEs)** are differential equations with ordinary derivatives (the ones we have been working with). 

<span style="font-size: 0.8em;">
*Sometimes functions have more than one variable and we can take **partial derivatives** with respect to each variable. Differential equations with partial derivatives are called **partial differential equations (PDEs)**.*
</span>

<br>

**Example**


<!----------------------------------------------------->


## {#diffeq data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

A **differential equation** is any equation which contains derivatives. 

The goal of the differential equation is to find a function that satisfies the equation. 

**Ordinary differential equations (ODEs)** are differential equations with ordinary derivatives (the ones we have been working with). 

<span style="font-size: 0.8em;">
*Sometimes functions have more than one variable and we can take **partial derivatives** with respect to each variable. Differential equations with partial derivatives are called **partial differential equations (PDEs)**.*
</span>

<br>

**Example**

The equation

$$
y' = y + x
$$

is a differential equation in which we want to find a function $y(x)$ such that its derivative equals the function plus $x$.

✏️ [Check that $y(x) = -x -1$ is a solution for this differential equation.]{style="color:green;"}

<!----------------------------------------------------->

## {#ln-ex data-menu-title="Natural Logs"}

[Differential wquations help us understand changing environments]{.slide-title}

<hr>


:::: {.columns}

::: {.column width="40%"}
- For some natural phenomena it can be easier to describe them in terms of derivatives than give an explicit function.

**Example**

[Lotka-Volterra models](https://en.wikipedia.org/wiki/Lotka–Volterra_equations) to describe preadtor prey dynamics:
$$
\begin{align}
\frac{dN_1}{dt}&=r_1N_1\left(\frac{K_1-N_1-\alpha N_2}{K_1}\right)\\
\frac{dN_2}{dt}&=r_2N_2\left(\frac{K_2-N_2-\beta N_1}{K_2}\right)
\end{align}
$$

where $N_1, N_2$ are the popylation of prey and preadtor respectively.
:::

::: {.column width="60%"}
![](images/lv.jpg){fig-align="center" width="90%"}
:::

::::


<!----------------------------------------------------->

## {#lok-model data-menu-title="Demonstration"}

[Differential equations are systems in motion]{.slide-title}

<hr>

:::: {.columns}

::: {.column width="40%"}
- Differential equations relate a quantity to its rate of change. 
- By specifying how something changes, we are describing a process over time. 
- We are finding whole trajectories or behaviors over time. 
:::

::: {.column width="60%"}
![[Phase space](https://en.wikipedia.org/wiki/Lotka–Volterra_equations)](images/pred.gif){fig-align="center" width="90%"}
:::
::::

<!----------------------------------------------------->

## {#ground data-menu-title="Groundwater"}

[Where will you run into ODEs?]{.slide-title}

<hr>


:::: {.columns}

::: {.column width="50%"}

- ESM 201: Ecology of Managed Ecosystems

Lotka-Volterra Models 
$$
\begin{align}
\frac{dN_1}{dt}&=r_1N_1\left(\frac{K_1-N_1-\alpha N_2}{K_1}\right)\\
\frac{dN_2}{dt}&=r_2N_2\left(\frac{K_2-N_2-\beta N_1}{K_2}\right)
\end{align}
$$

<!--
 Predator-prey dynamics.
 A pair of first-order nonlinear differential equations, frequently used to describe the dynamics of biological systems in which two species interact, one as a predator and the other as prey. The populations change through time according to the pair of equations.
-->

- ESM 222: Pollution Risk Management

 Groundwater transport of absorbed contaminant
$$
\frac{\partial C}{\partial t}=\left(\frac{D}{R}\frac{\partial^2t}{\partial x^2}\right)-\left(\frac{v}{R}\frac{\partial C}{\partial x}\right)-\frac{k}{R}C
$$

<!--
Contaminants moving and breaking down in groundwater.

Widely used in hydrogeology and environmental engineering to model how contaminants move and break down in groundwater.
-->
:::

::: {.column width="50%"}
![](images/lynx-hare-300.jpg){fig-align="center" width="70%"}

![](images/pollution.jpg){fig-align="center" width="70%"}
:::
::::



<!-- ## {#difficult data-menu-title="ODE are difficult"}

[We can use phase diagrams to understand the system]{.slide-title}

<hr>


::::{.columns}
:::{.column width="50%"}

```{r}
knitr::include_graphics("images/ramsey.jpg")
```

:::
:::{.column width="50%"}

- Find isoclines (where $dy/dx=0$)

- Determine the direction of the flow

- Find the equilibrium points

- Determine the stability of the equilibrium points

:::
:::: -->

## {#ode-steps data-menu-title="Steps for solving"}

[Steps to solving ODEs]{.slide-title}

<hr>

1. Move like terms to the same side, including differentials (dx,dy)

2. Apply the integral to both sides

3. Rearrange equations to isolate in terms of dependent variable

4. Use initial conditions (if given) to find C values

5. Evaluate the bounds if definite intervals are given

<!----------------------------------------------------->

## {#ode data-menu-title="Integration"}

[Practice Differential Equations]{.slide-title}

<hr>

$$
\frac{dy}{dx}=4y
$$

:::{.fragment .fade-in}

$$
\frac{dy}{4y}=dx
$$

:::

:::{.fragment .fade-in}

$$
\begin{align}
\int\frac{dy}{4y}&=\int dx\\
\frac{1}{4}\ln y&=x+C_1 \\
\ln y&=4x+C_2\\
y&=e^{4x+C_2} \\
y&=e^{C_2}e^{4x} \\
y&=Ce^{4x}
\end{align}
$$

:::


## {#ta data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Team Assessment</div>
</div>

## {#ta-q1 data-menu-title="Team Assessment Question 1"}

An oil spill of the coast of Santa Barbara is spreading rapidly. Previous spills and an analysis of the current indicate that the oil is spreading at a daily rate of:

$$
\frac{dA}{dt}=-0.001A+60
$$

Where A is the area of the oil spill in $km^2$ and t is the time in days.

If after the first day the oil has spread to 25 $km^2$, find an equation to show the spread of oil in total area.

When will the oil spill cover all of the Santa Barbara Channel (~5850 $km^2$)?

Hint:(The integral of $\frac{1}{ax+b}=\frac{ln(ax+b)}{a}$ Think reverse chain rule)



<!-- 
## {#trans data-menu-title="Numerical Calculus" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Numerical Calculus</div>
</div>


## {#functions data-menu-title="Functions in R"}

[Functions in R]{.slide-title}

<hr>


- Like functions in math, R functions are like baking recipes

```{r,eval=FALSE,echo=TRUE}

#cake       #recipe name (Ingredients)
output    <-  mean         (x,...)
```


<br>

<br>

:::{.fragment .fade-in}

```{r,echo=TRUE}
x<-mean(1:5,na.rm=TRUE)
x
```

- But where are the steps?

:::

## {#r-func data-menu-title="R functions documentation"}

[All functions have documentation]{.slide-title}

<hr>

- Any built in function in R describes the function and how to use it

<br>

```{r,eval=FALSE,echo=TRUE}
?seq
```

<br>

- Use Google to have more intuitive explanations 

<br>

- [Source Code is always available, but very difficult to comprehend](https://github.com/SurajGupta/r-source/blob/master/src/library/base/R/seq.R)

## {#mu-fun data-menu-title="My first function"}

[We can make our own functions]{.slide-title}

<hr>

```{r,echo=TRUE}
#Name i will give   Tell R we want to     Ingredients
#my function        make a function      List
my_first_fun       <-  function        (x,a)   {
  
  # Steps
  y=x+2*a
  
  return(y)  #The cake output
  
} # End the function steps
```


<br>

::: {.fragment}


```{r, echo=TRUE}
my_first_fun(x=1,a=2)
```

:::

## {#r-pieces data-menu-title="Key Pieces"}

[Key pieces of R functions]{.slide-title}

<hr>

1. *Name* - What are we going to call our function?

<br>

2.  *Ingredients*  - What goes into our function

<br>

3. *Steps*  - All the instructions we apply within our function contained within $\{\}$

    - Order of steps matter (i.e. can't evaluate z=w+x if x or w have not been created)
    
<br>

4. *Output* - What do we want the function to put out? (By default it is the last object, explicit with `return()`)

## {#r-arrange data-menu-title="Function arrangement"}

[Can you arrange this function into the correct order?]{.slide-title}

<hr>

::::{.columns}
:::{.column width="50%"}

A)
```{r,echo=TRUE,eval=FALSE}
b=(a+x)*y
```

B)
```{r,eval=FALSE,echo=TRUE}
}
```

C)
```{r,eval=FALSE,echo=TRUE}
a=x+y
```


:::
:::{.column width="50%"}

D)
```{r,eval=FALSE,echo=TRUE}
add_multiply<-function(x,y){
```


E)
```{r,eval=FALSE,echo=TRUE}
  return(b)
```
:::
::::

## {#order data-menu-title="Arrange Solution"}

[Solution]{.slide-title}

<hr>

```{r, echo=TRUE,eval=FALSE}
add_multiply<-function(x,y){
  
  a=x+y
  
  b=(a+x)*y
  
  return(b)
}

```
 -->
