---
format: 
  revealjs:
    chalkboard: true
    slide-number: true
    show-slide-number: print
    theme:
     - ../../ucsb-media.scss    
    html-math-method: mathjax
---

## {#title-slide data-menu-title="Title Slide" background=.white}

[Differential Equations and Numerical Calculus]{.custom-title .blue-text}

[Bren Calculus Workshop]{.custom-subtitle .gold}

<hr class="hr-teal">

[Carmen Galaz García, Ph.D.]{.body-text-l .center-text .blue-text}

[Bren School of Environmental Science & Management]{.center-text .body-text-m .blue-text}

<br>

<br>

[**Last updated:** `r format(Sys.time(), '%b %d, %Y')`]{.body-text-s .blue-text}

<br>

*Materials have been adapted and expanded from Nathaniel Grimes work for the Bren Calculus Workshop.*

<!--
## {#ta2-1 data-menu-title="Team Assessment 2 Questions"}


2) Take the Integrals

$$
\begin{align}
\text{A) }y=\frac{3}{x^2}, y(0)=5&  &\text{B)  }g(t)=3t^5-2t^3+16t-7  &  &\text{C) } \int^4_2\frac{1}{2}x
\end{align}
$$

3) A model for the rate of change in ozone concentrations over time between 1962-1984 is given by $\frac{dC}{dt}=2t+20$. Where $C$ is the ozone concentration (ppm) and t is the elapsed time in years. Given that in 1964 the ozone concentration was 30 ppm, what was the ozone concentration in 1982?
-->

## {#ln data-menu-title="Natural Logs"}

[Integral of the exponential function]{.slide-title}

<hr>

Since $\frac{d}{dx}e^x = e^x$, we have that

$$
\large
\int e^xdx=e^x+C
$$

<br>

- If the $x$ term gets more complex, we need [integration by parts](https://tutorial.math.lamar.edu/classes/calcii/integrationbyparts.aspx) or [substitution](https://tutorial.math.lamar.edu/classes/calci/substitutionruleindefinite.aspx). 

*This can get complicated and ee will not cover it in the workshop.*


## {#int-ln-blank data-menu-title="Natural logs"}

[Natural logs in integration]{.slide-title}

<hr>

<!----------------------------------------------------->

## {#int-ln data-menu-title="Natural logs"}

[Natural logs in integration]{.slide-title}

<hr>

Since $\frac{d}{dx} \ln(x) = \frac{1}{x}$ we have that

$$
\large
\int \frac{1}{x}=\ln x+C.
$$


On the other hand, we have that

$$
\begin{align}
\int \ln x&=x\ln x-x+C  
\end{align}
$$


This is computed using [integration by parts](https://www.youtube.com/watch?v=iw5eLJV0Sj4&embeds_referring_euri=https%3A%2F%2Fwww.khanacademy.org%2F&embeds_referring_origin=https%3A%2F%2Fwww.khanacademy.org).

✏️ [How would you check this second integral is correct?]{style="color:green;"}

<!----------------------------------------------------->

## {#intro-diff-eq data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Introduction to Differential Equations</div>
</div>

<!----------------------------------------------------->


## {#diffeq-blank-1 data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

<!----------------------------------------------------->


## {#diffeq-blank-2 data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

A **differential equation** is any equation which contains derivatives. 

The goal of the differential equation is to find a function that satisfies the equation. 

**Ordinary differential equations (ODEs)** are differential equations with ordinary derivatives (the ones we have been working with). 

<span style="font-size: 0.8em;">
*Sometimes functions have more than one variable and we can take **partial derivatives** with respect to each variable. Differential equations with partial derivatives are called **partial differential equations (PDEs)**.*
</span>

<br>

**Example**


<!----------------------------------------------------->


## {#diffeq data-menu-title="Diff Eq"}

[What is a differential equation?]{.slide-title}

<hr>

A **differential equation** is any equation which contains derivatives. 

The goal of the differential equation is to find a function that satisfies the equation. 

**Ordinary differential equations (ODEs)** are differential equations with ordinary derivatives (the ones we have been working with). 

<span style="font-size: 0.8em;">
*Sometimes functions have more than one variable and we can take **partial derivatives** with respect to each variable. Differential equations with partial derivatives are called **partial differential equations (PDEs)**.*
</span>

<br>

**Example**

The equation

$$
y' = y + x
$$

is a differential equation in which we want to find a function $y(x)$ such that its derivative equals the function plus $x$.

✏️ [Check that $y(x) = -x -1$ is a solution for this differential equation.]{style="color:green;"}

<!----------------------------------------------------->

## {#ln-ex data-menu-title="Natural Logs"}

[Differential wquations help us understand changing environments]{.slide-title}

<hr>


:::: {.columns}

::: {.column width="40%"}
- For some natural phenomena it can be easier to describe them in terms of derivatives than give an explicit function.

**Example**

[Lotka-Volterra models](https://en.wikipedia.org/wiki/Lotka–Volterra_equations) to describe preadtor prey dynamics:
$$
\begin{align}
\frac{dN_1}{dt}&=r_1N_1\left(\frac{K_1-N_1-\alpha N_2}{K_1}\right)\\
\frac{dN_2}{dt}&=r_2N_2\left(\frac{K_2-N_2-\beta N_1}{K_2}\right)
\end{align}
$$

where $N_1, N_2$ are the popylation of prey and preadtor respectively.
:::

::: {.column width="60%"}
![](images/lv.jpg){fig-align="center" width="90%"}
:::

::::


<!----------------------------------------------------->

## {#lok-model data-menu-title="Demonstration"}

[Differential equations are systems in motion]{.slide-title}

<hr>

:::: {.columns}

::: {.column width="40%"}
- Differential equations relate a quantity to its rate of change. 
- By specifying how something changes, we are describing a process over time. 
- We are finding whole trajectories or behaviors over time. 
:::

::: {.column width="60%"}
![[Phase space](https://en.wikipedia.org/wiki/Lotka–Volterra_equations)](images/pred.gif){fig-align="center" width="90%"}
:::
::::

<!----------------------------------------------------->

## {#ground data-menu-title="Groundwater"}

[Where will you run into ODEs?]{.slide-title}

<hr>


:::: {.columns}

::: {.column width="50%"}

- ESM 201: Ecology of Managed Ecosystems

Lotka-Volterra Models 
$$
\begin{align}
\frac{dN_1}{dt}&=r_1N_1\left(\frac{K_1-N_1-\alpha N_2}{K_1}\right)\\
\frac{dN_2}{dt}&=r_2N_2\left(\frac{K_2-N_2-\beta N_1}{K_2}\right)
\end{align}
$$

<!--
 Predator-prey dynamics.
 A pair of first-order nonlinear differential equations, frequently used to describe the dynamics of biological systems in which two species interact, one as a predator and the other as prey. The populations change through time according to the pair of equations.
-->

- ESM 222: Pollution Risk Management

 Groundwater transport of absorbed contaminant
$$
\frac{\partial C}{\partial t}=\left(\frac{D}{R}\frac{\partial^2t}{\partial x^2}\right)-\left(\frac{v}{R}\frac{\partial C}{\partial x}\right)-\frac{k}{R}C
$$

<!--
Contaminants moving and breaking down in groundwater.

Widely used in hydrogeology and environmental engineering to model how contaminants move and break down in groundwater.
-->
:::

::: {.column width="50%"}
![](images/lynx-hare-300.jpg){fig-align="center" width="70%"}

![](images/pollution.jpg){fig-align="center" width="70%"}
:::
::::



<!-- ## {#difficult data-menu-title="ODE are difficult"}

[We can use phase diagrams to understand the system]{.slide-title}

<hr>


::::{.columns}
:::{.column width="50%"}

```{r}
knitr::include_graphics("images/ramsey.jpg")
```

:::
:::{.column width="50%"}

- Find isoclines (where $dy/dx=0$)

- Determine the direction of the flow

- Find the equilibrium points

- Determine the stability of the equilibrium points

:::
:::: -->
## {#ode-steps-blank data-menu-title="Steps for solving"}

[Separation of variables]{.slide-title}

<hr>

:::: {.columns}

::: {.column width="40%"}

A first-order ODE of the form $\frac{dy}{dx} = f(x)g(y)$ can be solved in the following steps:


:::

::: {.column width="60%"}
<div class="page-center">
✏️ [Solve for $y$ in $\frac{dy}{dx}=4y$]{style="color:green;"}
</div>

:::

::::

## {#ode-steps data-menu-title="Steps for solving"}

[Separation of variables]{.slide-title}

<hr>

:::: {.columns}

::: {.column width="40%"}

A first-order ODE of the form $\frac{dy}{dx} = f(x)g(y)$ can be solved in the following steps:

1. Move like terms to the same side, including differentials $dx\text{ and } dy$. *This is a convenient shorthand for more involved calculus steps.*


2. Apply the integral to both sides.


3. Rearrange equations to isolate in terms of dependent variable.


4. Use initial conditions (if given) to find $C$ values.


5. Evaluate the bounds if definite intervals are given.
:::

::: {.column width="60%"}
<div class="page-center">
✏️ [Solve for $y$ in $\frac{dy}{dx}=4y$]{style="color:green;"}
</div>

$$
\begin{align}
\frac{dy}{4y}& =dx \\
\int\frac{dy}{4y}&=\int dx\\
\frac{1}{4}\ln y&=x+C_1 \\
\ln y&=4x+C_2\\
y&=e^{4x+C_2} \\
y&=e^{C_2}e^{4x} \\
y&=Ce^{4x}
\end{align}
$$
:::

::::


## {#ta data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Team Assessment</div>
</div>

## {#ta-q1 data-menu-title="Team Assessment Question 1"}

1) Verify that $$\int \frac{1}{ax+b} dx = \frac{\ln(ax+b)}{a}.$$

. . .

2) An oil spill off the coast of Santa Barbara is spreading rapidly. Previous spills and an analysis of the current data indicate that the oil is spreading at a daily rate of:

$$
\frac{dA}{dt}=-0.001A+60,
$$

where $A$ is the area of the oil spill in $km^2$ and $t$ is the time in days.

A) Find an equation that models the spread of oil in total area. Hint: exercise 1.

B) After the first day the oil has spread to 25 $km^2$. What steps would you take to find when will the oil spill cover all of the Santa Barbara Channel (~5850 $km^2$)? *You don't need to compute it, just come up with a solid plan.*


## {#ta-solutions data-menu-title="Team Assessment Question 1" .smaller}

[Solution 2.a.]{.slide-title}

We are given the differential equation:

$$
\frac{dA}{dt} = -0.001 A + 60
$$

Step 1: Rearrange for separation of variables

$$
\frac{dA}{dt} = 60 - 0.001 A \quad \implies \quad \frac{dA}{60 - 0.001 A} = dt
$$

Step 2: Integrate both sides

$$\int \frac{1}{60 - 0.001 A} \, dA = \int dt$$


Using the hint:

$$-1000 \ln(60 - 0.001 A) = t + C_1$$

Step 3: Solve for \(A\)

$$\ln(60 - 0.001 A) = -0.001 (t + C_1)$$

$$60 - 0.001 A = e^{-0.001 (t + C_1)} = C e^{-0.001 t} \quad (\text{combine constants})$$

$$0.001 A = 60 - C e^{-0.001 t}$$

$$\boxed{A(t) = 60000 - C e^{-0.001 t} \text{, \  where $C$ is an arbitrary constant.}}$$

<!----------------------------------------------------->

## {#wrap-up data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Wrap up!</div>
</div>

