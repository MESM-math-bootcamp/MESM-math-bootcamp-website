---
format: 
  revealjs:
    chalkboard: true
    slide-number: true
    show-slide-number: print
    theme:
     - ../../ucsb-media.scss    
    html-math-method: mathjax
    # include-in-header:
    #   - text: |
    #       <script>
    #       MathJax = {
    #         options: {
    #           menuOptions: {
    #             settings: {
    #               assistiveMml: false
    #             }
    #           }
    #         }
    #       };
    #       </script>
---


```{r}
library(tidyverse)
```


## {#title-slide data-menu-title="Title Slide" background=.white}

[Introduction to Integration]{.custom-title .blue-text}

[Bren Calculus Workshop]{.custom-subtitle .gold}

<hr class="hr-teal">

[Carmen Galaz García, Ph.D.]{.body-text-l .center-text .blue-text}

[Bren School of Environmental Science & Management]{.center-text .body-text-m .blue-text}

<br>

<br>

[**Last updated:** `r format(Sys.time(), '%b %d, %Y')`]{.body-text-s .blue-text}

<br>

*Materials have been adapted and expanded from Nathaniel Grimes work for the Bren Calculus Workshop.*


## {#tr data-menu-title="Team Review"}

[Problem set review]{.slide-title}

<hr>

- How did everyone feel about the problem set?

- Any questions?

<!----------------------------------------------------->
## {#logarithm-motivation title="Exponential function revisited"}

[Exponential function revisited]{.slide-title}

<hr>

Remeber: the **exponential function** $e^x$ is the number $e$ raised to the $x$ power. 

```{r,fig.align='center',out.width="60%"}

x=seq(-3,3,by=0.01)
y=exp(x)

ggplot()+
  geom_line(aes(x=x,y=y),color="black",linewidth=3)+
  theme_classic()+
  labs(x="x",y="y",title=bquote(e^x))+
  theme(text=element_text(size=28))
```

A reasonable question would be:

<br>

<div class="page-center">
<span style="color:red">
Given $y$, what is the $x$ such that $e^x = y$?
</span>
</div>

<!----------------------------------------------------->
## {#ln-blank-1 data-menu-title="Natural Logs"}

[Natural logarithms]{.slide-title}

<hr>


<!----------------------------------------------------->
## {#ln-blank-2 data-menu-title="Natural Logs"}

[Natural logarithms]{.slide-title}

<hr>

If $y>0$ then **$\ln(x)$ is the exponent you need to raise $e$ to in order to get $y$.**

This means:

$$
\begin{align}
\ln(e^x) &= x \\
e^{\ln(y)} &= y
\end{align}
$$

In other words, $\ln(x)$ is the inverse of the exponential function $e^x$. 

<br>

**Examples**

- $\ln(e^3)$

- $\ln(\frac{1}{e})$

- $\ln(1)$

- $\ln(0)$ 

- $\ln(-7)$ 


<!----------------------------------------------------->
## {#ln data-menu-title="Natural Logs"}

[Natural logarithms]{.slide-title}

<hr>

If $y>0$ then **$\ln(x)$ is the exponent you need to raise $e$ to in order to get $y$.**

This means:

$$
\begin{align}
\ln(e^x) &= x \\
e^{\ln(y)} &= y
\end{align}
$$

In other words, $\ln(x)$ is the inverse of the exponential function $e^x$. 

<br>

**Examples**

- $\ln(e^3) = 3$ because 3 is the power of $e$ needed to get $e^3$.

- $\ln(\frac{1}{e}) = \ln(e^{-1}) = -1$

- $\ln(1) = 0$ because 0 is the exponent we need to raise $e$ to to get 1

- $\ln(0)$ does not exist, because there's no number we can raise $e$ to to get 0

- $\ln(-7)$ does not exist, because $e$ to any number always be positive

<!----------------------------------------------------->
## {#ln data-menu-title="Properties of natural logarithm"}

[Natural log properties]{.slide-title}

<hr>

::::{.columns}
:::{.column width="50%"}

:::{.fragment .fade-in}
```{r,fig.dim=c(5,5.5), out.width="100%"}

# Define x values
x_exp <- seq(-2, 4, length.out = 500)          # for e^x
x_log <- seq(0.001, 4, length.out = 500)       # for ln(x) (x>0 only)

# Compute y values
y_exp <- exp(x_exp)
y_log <- log(x_log)

# Base plot: no axes, no box, no margin labels
plot(x_exp, y_exp, type = "l", col = "blue", lwd = 2,
     xlab = "", ylab = "",
     xlim = c(-2, 4), ylim = c(-2, 6),         
     main = "",
     axes = FALSE, frame.plot = FALSE)

# Draw custom axes at x=0 and y=0
axis(1, pos = 0)  # x-axis at y=0
axis(2, pos = 0)  # y-axis at x=0

# Add ln(x)
lines(x_log, y_log, col = "red", lwd = 2)

# Add the line y = x (dotted)
abline(0, 1, lty = 2, col = "darkgreen")

# Add legend (no box)
legend("topleft", legend = c("e^x", "ln(x)", "y=x"),
       col = c("blue", "red", "darkgreen"), lwd = c(2,2,1),
       lty = c(1,1,2), bty = "n")

# Add manual axis labels at the ends
text(x = 4, y = -0.2, labels = "x", cex = 1.2)
text(x = 0.2, y = 6, labels = "y", cex = 1.2) 
```

:::
:::

:::{.column width="50%"}

:::{.fragment .fade-in}
:::{.center-text}
**Properties**
:::


$\ln (e^x)=x$

$\ln(xy)=\ln x+\ln y$

$\ln(\frac{x}{y})=\ln x-\ln y$

$\ln(x^y)=y \ln x$
:::

:::
::::

<!----------------------------------------------------->
## {#ln-ex-blank data-menu-title="Natural Logs"}

[Using logarithms to solve equations]{.slide-title}

<hr>
✏️ [Solve for $t$ in the equation $Pe^{rt} = A$. ]{style="color:green;"}

::::{.columns}
:::{.column width="70%"}
:::

:::{.column width="30%"}
:::{.center-text}
**Properties**
:::

$\ln (e^x)=x$

$\ln(xy)=\ln x+\ln y$

$\ln(\frac{x}{y})=\ln x-\ln y$

$\ln(x^y)=y \ln x$
:::

::::

<!----------------------------------------------------->
## {#ln-ex data-menu-title="Natural Logs"}

[Using logarithms to solve equations]{.slide-title}

<hr>
✏️ [Solve for $t$ in the equation $Pe^{rt} = A$. ]{style="color:green;"}

$$
\begin{align}
Pe^{rt} &= A \\
e^{rt} & = \frac{A}{P} \\
rt &= \ln\left(\frac{A}{P}\right) \\
t &= \frac{\ln(A)-\ln(P)}{r}
\end{align}
$$

<!----------------------------------------------------->

## {#d-ln-blank data-menu-title="Natural logs"}

[Derivative of Natural Log]{.slide-title}

<hr>

<!----------------------------------------------------->

## {#d-ln data-menu-title="Natural logs"}

[Derivative of natural log]{.slide-title}

<hr>
The derivative of the natural logarithm is

$$
\large
\frac{d}{dx}\ln x=\frac{1}{x}
$$

::::{.columns}
:::{.column width="50%"}

:::{.center-text}
**Math uses**:
:::

- Allows us to more easily handle exponents $(e^x)$

- Surprisingly simple derivative!

- Important in integration
:::
:::{.column width="50%"}

:::{.center-text}
**Real World Uses**
:::


- Time and growth Problems

- Differential equations

:::
::::

<!----------------------------------------------------->

## {#ln-derv-ex-blank data-menu-title="Natural Log"}

[Example]{.slide-title}

<hr>

✏️ [Find the derivative of $y=\ln(x^2)$. ]{style="color:green;"}

<!----------------------------------------------------->

<!-- ## {#ln-derv-ex-composition data-menu-title="Natural Log"}

[Example]{.slide-title}

<hr>

There are two 

✏️ [Find the derivative of $y=\ln(x^2)$. ]{style="color:green;"}

TODO: add a solution with composition of functions. -->

<!----------------------------------------------------->

## {#ln-derv-ex data-menu-title="Natural Log"}

[Example]{.slide-title}

<hr>

✏️ [Find the derivative of $y=\ln(x^2)$. ]{style="color:green;"}

A solution with $u$-substitution.

$$
\begin{align}
y=\ln(u)& &u=x^2\\
\frac{dy}{du}&=\frac{1}{u} &\frac{du}{dx}=2x \\
\frac{dy}{du}\frac{du}{dx}&=\frac{2x}{u} &\text{By Chain Rule}\\
\frac{dy}{dx}&=\frac{2x}{x^2}\\
\frac{dy}{dx}&=\frac{2}{x}\\
\end{align}
$$

<!----------------------------------------------------->

## {#ta data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Team Assessment</div>
</div>

<!----------------------------------------------------->

## {#ta-1 data-menu-title="Team Assessment"}

1) Solve these equations

$$
\begin{align}
\text{A)  }5+\ln(3x)=7  &  &\text{B) } e^{5x-0.2}=10
\end{align}
$$

<br>

2) Find the derivative of $f(x)=x \ln x.$

<br>

3) You contribute monthly to your retirement a company. After leaving the company, you no longer contribute, but the fund continues to accrue interest until you can remove it without penalty at age 55.

The increase in your funds is given by: 
$$R=122000e^{0.032 t}$$ 

where $R$ is the amount in your retirement account $t$ years after leaving the company.

How many years after you quit will your retirement account be earning $8000/year in interest?

<!----------------------------------------------------->

## {#solutions-1 data-menu-title="Solutions"}

[Solutions]{.slide-title}

<hr>

:::: {.columns}
::: {.column width="50%"}
A) 

$$
\begin{align}
5 + \ln(3x) &= 7 \\
\ln(3x) &= 2 \\
3x &= e^2 \\
x & = \frac{e^2}{3} \\
\end{align}
$$
:::

::: {.column width="50%"}
B) 

$$
\begin{align}
e^{5x-0.2} &= 10 \\
\ln(e^{5x-0.2}) &= \ln(10) \\
5x-0.2 &= \ln(10) \\
5x &= \ln(10) + 0.2 \\
x &= \frac{\ln(10) + 0.2}{5}
\end{align}
$$
:::
::::

2. 

To take the derivative of $f(x) = x\ln(x)$ we can use the product rule: $(fg)' = f'g + fg'$. 
Using this we have that

$$
f'(x) = 1\ln(x) + x\frac{1}{x} = \ln(x) + 1. 
$$



<!----------------------------------------------------->

## {#integrate-concept data-menu-title="Integration" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Integration Conceputally</div>
</div>

## {#xkcd data-menu-title="Integration"}

```{r out.width="55%",fig.align='center'}
knitr::include_graphics("https://imgs.xkcd.com/comics/differentiation_and_integration.png")
```

## {#auc data-menu-title="Area under the curve"}

[How do we find the area under this curve?]{.slide-title}

<hr>

```{r}
knitr::include_graphics("images/area.png")
```


## {#rect-approx data-menu-title="Area under the curve"}

[We can approximate the area by summing the area of easy to calculate rectangles]{.slide-title}

<hr>

```{r}
knitr::include_graphics("images/reimann.png")
```


## {#rect data-menu-title="Reimann Sum"}

[How do we make the rectangles]{.slide-title}

<hr>
1. Start at one end of the interval $[a,b]$

2. Evaluate the function at $f(a)$

3. Step away from $a$ by some small amount called $\Delta x$

4. Multiply $f(a)\Delta x$

5. Repeat the same steps above, but keep moving the function evaluation to new intervals

6. Sum up all (k) rectangles

$$
\text{Area}=f(x_1)\Delta x+f(x_2)\Delta x+...f(x_k)\Delta x
$$

This is called a **Reimann Sum**

## {#reinsum data-menu-title="Reimann Sum"}

[Example of Reimann Sum]{.slide-title}

<hr>

Approximate the area under the curve from $[-3,3]$ with $\Delta x=1$ and $k=6$

:::{.columns}

:::{.column width="30%"}
```{r}
x=seq(-5,5,by=.1)
y=x^3-12*x+2

x_tab=seq(-3,3,by=1)
y_tab=x_tab^3-12*x_tab+2


data.frame(x=x_tab,y=y_tab) %>% 
  knitr::kable()
#DT::datatable(round(data.frame(x=x_tab,y=y_tab),2),
              #fillContainer = FALSE, options = list(pageLength = 6))
```
:::

:::{.column width="70%"}

```{r,out.width="90%"}
ggplot()+
  geom_line(aes(x=x,y=y),size=2.5,color="#003660")+
  theme_classic()+
  annotate("segment",x=-3,xend=-3,y=11,yend=-63,linetype=1,color="#FEBC11",size=2)+
  annotate("segment",x=3,xend=3,y=-7,yend=-63,color="#FEBC11",size=2)+
  theme(text = element_text(size = 28))+
  scale_y_continuous(expand=c(0,0))+
  scale_x_continuous(breaks=seq(-5,5))
```
:::

::::



## {#exp-reimman data-menu-title="Reimann Sum"}

[Expanding Reimann Sums]{.slide-title}

<hr>

- What if we try to make $\Delta x$ really small and the number of rectangles really big $(k\to \infty)$?

- Our estimation of the Area will get better and better with more rectangles

:::{.fragment .fade-in}

```{r,fig.align='center'}
knitr::include_graphics("images/riemann.gif")
```
:::



## {#integral data-menu-title="Integrals"}

[Take the limits to infinity]{.slide-title}

<hr>


Take the area calculation we did before, but with infinitely many $ks$

$$
\large
\lim_{k\to\infty}R(f(x),\Delta x)=\text{True Area}
$$

We formally call this an integral with the following notation:

$$
\large
\int^b_af(x)dx
$$

Verbally:

*The Integral of $f(x)$ from $a$ to $b$ with respect to $x$*

## {#integral-calc data-menu-title="Integrals"}

[How do we calculate]{.slide-title}

<hr>

- Taking infinite sums is tedious to impossible by hand

<br>

- Luckily the $dx$ portion hints at the way to solve integrals


## {#fundamental data-menu-title="Fundamental Theorem of Calculus"}

[Fundamental Theorem of Calculus]{.slide-title}

<hr>

If $f(x)$ is continuous over an interval $[a,b]$, and the function $F(x)$ is defined by:

$$
\large
F(x)=\int^x_af(t)dt
$$

then $F'(x)=f(x)$ over $[a,b]$


## {#ftoc data-menu-title="Fundamental Theorem of Calculus"}

[Fundamental Theorem of Calculus means that Integrals are just Anti-Derivatives]{.slide-title}

<hr>
If we integrate a derivative, we should get the same function back as the original vice-versa

$$
\begin{align}
\frac{d}{dx}\left[\int f(x)dx\right]&=f(x) &\text{Differentiation is the inverse of integration}
\end{align}
$$

:::{.fragment .fade-in}

$$
\begin{align}
\int f'(x)&=f(x)+C &\text{Integration is the inverse of differentiation}
\end{align}
$$
:::

## {#c data-menu-title="Constants of Integration"}

[Where the heck did that C come from?]{.slide-title}

<hr>

::::{.columns}
:::{.column width="50%"}
- Start with $x^2-4x+1$

- $\frac{d}{dx}=2x-4$

- If we integrate, we'll have $x^2-4x+C$

- There is no way of knowing what the x-intercept should be without additional information

- We have to solve with an initial value problem

:::
:::{.column width="50%"}
```{r,out.width="75%"}
knitr::include_graphics("images/c.png")
```
:::
::::

## {#integratal-use data-menu-title="Why is Integration useful"}

[Why is Integration Useful?]{.slide-title}

<hr>
- Convert from rate of changes to total values

<br>

- Solve Differential Equations

    - i.e $\frac{dy}{dx}=2x-4$
    
    - Logistic Growth is one example
    
<br>    

- Total area of curves

    - Useful in policy evaluations



## {#tough data-menu-title="Integration is tough"}

[Integration is tough]{.slide-title}

<hr>

**Before integrating ask yourself:**

1. What am I trying to solve?

<br>

2. Does it make sense to take an integral?

## {#rules-cover data-menu-title="Rules of Integration" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Rules of Integration</div>
</div>

## {#sum-diff data-menu-title="Rules of Integration"}

[Follow many of the same rules for derivatives]{.slide-title}

<hr>

:::{.center-text}
**Sum and Difference Rules**
:::

$$
\begin{align}
\int[f(x)+g(x)]dx=\int f(x)dx+\int g(x)dx \\
\int[f(x)-g(x)]dx=\int f(x)dx-\int g(x)dx 
\end{align}
$$

## {#constant data-menu-title="Rules of Integration"}

[Rules of Integration]{.slide-title}

<hr>

:::{.center-text}
**Constant Rules**
:::


$$
\begin{align}
\int k dx&=kx+C \\
\int kf(x)dx&=k\int f(x)dx
\end{align}
$$

- Second part says we can move multipliers outside the integration to simplify. 

## {#power data-menu-title="Rules of Integration"}

[Rules of Integration]{.slide-title}

<hr>

:::{.center-text}
**Power Rule**
:::

$$
\int x^ndx=\frac{x^{n+1}}{n+1}+C \text{, n}\ne1
$$

- Workhorse rule of integration

## {#examples data-menu-title="Examples of Integration"}

[Examples]{.slide-title}

<hr>

$$
\begin{align}
f(x)&=4 & &g(x)=2x^2  &f(x)=x^3-4x
\end{align}
$$

## {#ivp data-menu-title="Initial Value Problems"}

[Initial Value Problems]{.slide-title}

<hr>

```{r,fig.align='center',out.width="80%"}
knitr::include_graphics("images/increase.PNG")
```


- To find the C terms, we need extra information

- Often times that comes from being given an *initial value*

- The start of the period we know that $y(0)=a$ or $y(12)=b$

- We use this information to solve for what C should be



## {#ivp-ex  data-menu-title="Initial Value Problem"}

[Initial Value Problem: Example]{.slide-title}

<hr>

The marginal cost of producing $x$ units of a product is:

$$
\frac{dC}{dx}=25-0.02x
$$

Where C is the cost ($), and x is the number of units produced. Given that producing 2 units of product costs \$10, what is the complete cost equation?

:::{.fragment .fade-in}

$$
\begin{align}
C(x)=&25x-\frac{.02x^2}{2}+D & \text{Solve with Power Rule}\\
10&=25(2)-\frac{0.02(2)^2}{2}+D  &\text{ Sub in x=2}\\
-39.96&=D\\
C(x)&=25x-\frac{0.2x^2}{2}-39.96
\end{align}
$$
:::

## {#definte data-menu-title="Definite vs Indefinite"}

[Definite vs indefinite integrals]{.slide-title}

<hr>

::::{.columns}

:::{.column width="50%"}

- Definite integrals have start and end values (aka bounds)

- We must evaluate between the intervals by

$$
\begin{align}
\int^b_axdx\\
\frac{1}{2}x^2|^b_a\\
\frac{1}{2}(b)^2-\frac{1}{2}(a)^2
\end{align}
$$

:::

:::{.column width="50%"}
- Indefinite Integrals no bounds 

- Need initial values to find integration constants

$$
\int f(x)dx
$$

:::
::::

## {#def-solve data-menu-title="Definite Integral"}

[Definite Integral: Example]{.slide-title}

<hr>
$$
\begin{align}
\int^2_{-1}3x^2dx \\
x^3|^2_{-1}\\
(2)^3-(-1)^3=9
\end{align}
$$


## {#area data-menu-title="Area between Curves"}

[Area between curves]{.slide-title}

<hr>

```{r,out.width="80%"}
knitr::include_graphics("images/twocurve.png")
```


## {#area-ex1 data-menu-title="Area between curves"}

[Area between curves example]{.slide-title}

<hr>

Find the area of the shaded region in the graph below

```{r}
knitr::include_graphics("images/diffxtwo.gif")
```

## {#area-ex2 data-menu-title="Area between curves"}

[Area between curves example]{.slide-title}

<hr>

$$
\small
\begin{align}
\int^1_0 \sqrt{x}=\frac{2}{3}x^\frac{3}{2} \\
\int^1_0 x^2=\frac{1}{3}x^3
\end{align}
$$

:::{.fragment .fade-in}

- Then get the area of each by solving the definite integral

$$
\small
\begin{align}
\frac{2}{3}(1)^{\frac{3}{2}}-\frac{2}{3}(0)^{\frac{3}{2}}=\frac{2}{3}\\
\frac{1}{3}(1)^3-\frac{1}{3}(0)^3=\frac{1}{3}
\end{align}
$$

:::

:::{.fragment .fade-in}

- Then subtract the upper from the lower

$$
\small
\frac{2}{3}-\frac{1}{3}=\frac{1}{3}
$$

:::


## {#ta-2 data-menu-title="Team Assessment" background-color="#003660"}

<div class="page-center">
<div class="custom-subtitle">Team Assessment</div>
</div>

## {#ta2-1 data-menu-title="Team Assessment 2 Questions"}

1) Explain and demonstrate how to approximate the area under the curve $f(x)=-9x^3+3x-9$ on the interval [4,10] using a Riemann sum with $k=3$

2) Take the Integrals

$$
\begin{align}
\text{A) }y=\frac{3}{x^2}, y(0)=5&  &\text{B)  }g(t)=3t^5-2t^3+16t-7  &  &\text{C) } \int^4_2\frac{1}{2}x
\end{align}
$$

3) A model for the rate of change in ozone concentrations over time between 1962-1984 is given by $\frac{dC}{dt}=2t+20$. Where $C$ is the ozone concentration (ppm) and t is the elapsed time in years. Given that in 1964 the ozone concentration was 30 ppm, what was the ozone concentration in 1982?
